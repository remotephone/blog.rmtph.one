<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CyberDefenders.org - Malware Traffic Analysis Walktrhough | Notepad+++</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="CyberDefenders.org - Malware Traffic Analysis Walktrhough" /><meta name="author" content="remotephone" /><meta property="og:locale" content="en_US" /><meta name="description" content="CyberDefenders.org" /><meta property="og:description" content="CyberDefenders.org" /><link rel="canonical" href="https://remotephone.github.io/posts/CyberDefenders_MTA/" /><meta property="og:url" content="https://remotephone.github.io/posts/CyberDefenders_MTA/" /><meta property="og:site_name" content="Notepad+++" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-08T01:40:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CyberDefenders.org - Malware Traffic Analysis Walktrhough" /><meta name="twitter:site" content="@remotephone" /><meta name="twitter:creator" content="@remotephone" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"remotephone"},"description":"CyberDefenders.org","@type":"BlogPosting","headline":"CyberDefenders.org - Malware Traffic Analysis Walktrhough","url":"https://remotephone.github.io/posts/CyberDefenders_MTA/","dateModified":"2021-04-08T01:40:00-05:00","datePublished":"2021-04-08T01:40:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://remotephone.github.io/posts/CyberDefenders_MTA/"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@remotephone"><meta name="twitter:title" content="CyberDefenders.org - Malware Traffic Analysis Walktrhough"><meta name="twitter:description" content="My personal blog, mostly security focused."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://remotephone.github.io/images/avatar.jpg"><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/images/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Notepad+++</a></div><div class="site-subtitle font-italic">Break it, fix it, write it down.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/remotephone" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/remotephone" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['remotephone','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>CyberDefenders.org - Malware Traffic Analysis Walktrhough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CyberDefenders.org - Malware Traffic Analysis Walktrhough</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Apr 8, 2021, 1:40 AM -0500" > Apr 8, 2021 <i class="unloaded">2021-04-08T01:40:00-05:00</i> </span> by <span class="author"> remotephone </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 8, 2022, 10:17 PM -0500" > Jul 8 <i class="unloaded">2022-07-08T22:17:59-05:00</i> </span></div></div><div class="post-content"><h1 id="cyberdefendersorg">CyberDefenders.org</h1><p><a href="https://cyberdefenders.org/">CyberDefenders</a> is a free, community built site hosting security challenges. I’d heard about this site and it’s interesting, so I thought I’d use a little bit of the pandemic to work through some of their exercises. I’ve also previously worked through exercises from and learned a lot from @malware_traffic (Brad Duncan of Palo Alto) so I thought his would be a good place to start. I’m starting on his first post <a href="https://cyberdefenders.org/labs/17">here</a>. I will be defanging the IOCs, but use caution.</p><h2 id="setup">Setup</h2><p>I am using a Windows computer. If you don’t have one, grab one of the VMs <a href="https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/">here</a> or adjust the instructions for your OS. I’ve never used the tool, but Brad recommends using Brim, which brings together Suricata, Zeek, and Wireshark like functionality all in one too. I like all those tools, so let’s try it out. You’ll optionally want Wireshark installed.</p><ol><li>Download the Brim <a href="https://www.brimsecurity.com/download/">installer</a> and install it. The install screen is weird, just let it do its thing for a few minutes.</li><li>Install <a href="https://suricata-ids.org/download/">Suricata</a>. You won’t need to run it as an IDS, we’ll import it into Brim though.</li><li>Launch Brim, go to File &gt; Settings and point the Suricata runner to your executable. The default path should be at <code class="language-plaintext highlighter-rouge">C:\Program Files\Suricata\suricata.exe</code>. Restart Brim</li><li>Download an unzip the challenge materials.</li><li>Import the file.</li></ol><p>Now you’re ready to go. On successful import, you’ll have something like this</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://remotephone.github.io/images/brim_mta1_1.png" alt="Brim ready to go" class="center-image" /></p><h2 id="analysis">Analysis</h2><h3 id="question-1-what-is-the-ip-address-of-the-windows-vm-that-gets-infected">Question 1: What is the IP address of the Windows VM that gets infected?</h3><p>Brim seems to have a bunch of prepackaged queries that will probably help us investigate. If you look in the Queries section, you can see things like <code class="language-plaintext highlighter-rouge">HTTP Requests</code>, <code class="language-plaintext highlighter-rouge">File Activity</code>, etc etc. <code class="language-plaintext highlighter-rouge">Suricata alerts by Source and Destination</code> is going to be the first place to go. We see 2 alerts, and right away the internal host <code class="language-plaintext highlighter-rouge">172.16.165.165</code> stands out. Now, right click and <code class="language-plaintext highlighter-rouge">Pivot to logs</code> to get more detailed information. The query defaults to <code class="language-plaintext highlighter-rouge">event_type=alert src_ip=172.16.165.165 dest_ip=37.200.69.143</code>, but we can swap that to <code class="language-plaintext highlighter-rouge">event_type=alert dest_ip=172.16.165.165</code> so we can see what’s headed to our host we’re suspicious of. Going to the first alert by time, we see an alert for a possible GoonEK encrypted binary.</p><p>We can look up the rule by googling <code class="language-plaintext highlighter-rouge">suricata rule 2018297</code> and seeing the source <a href="https://github.com/OISF/suricata-update/blob/master/tests/emerging-current_events.rules#L2661">here</a>. This rule looks at traffic for the hex content <code class="language-plaintext highlighter-rouge">89 b4 f4 6a 24 1f 46 14</code>. <a href="https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')&amp;input=ODkgYjQgZjQgNmEgMjQgMWYgNDYgMTQ">Cyberchef</a> doesn’t decode that to anything obvious, so without going too much into it we’ll take their word for it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://remotephone.github.io/images/brim_mta1_2.png" alt="Suricata GoonEK Alert" class="center-image" /></p><p>Sorting the signatures with this host as the destination, we start to see a clearer picture and can probably answer question 1 with some condfidence.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://remotephone.github.io/images/brim_mta1_3.png" alt="Suricata GoonEK Alert List" class="center-image" /></p><h3 id="question-2-3-what-is-the-hostnamemac-address-of-the-windows-vm-that-gets-infected">Question 2-3: What is the hostname/mac address of the Windows VM that gets infected?</h3><p>This is pretty straight forwad, we should expect to see this in DHCP traffic. The query <code class="language-plaintext highlighter-rouge">_path=dhcp</code> shows you the events and the host_name field comes up pretty easily. Same for the mac address.</p><h3 id="question-4-8-what-is-the-iphostname-of-compromised-website-and-exploit-delivery-redirect-url">Question 4-8: What is the IP/hostname of compromised website and exploit delivery? Redirect URL?</h3><p>So we probably have to work backwards in time a little more here. The alerts for EK delivery were from <code class="language-plaintext highlighter-rouge">37.200.69.143</code>, but that may not have been the original compromised site. We can use this query to search for all HTTP Traffic: <code class="language-plaintext highlighter-rouge">_path=http | cut ts, id.orig_h, id.resp_h, id.resp_p, method,host, uri | uniq -c | sort ts</code>. If we add <code class="language-plaintext highlighter-rouge">referrer</code> to the query, we can more easily see how this progressed. We can see the original host that began the malicious redirects is <code class="language-plaintext highlighter-rouge">www.ciniholland[.]nl</code> at <code class="language-plaintext highlighter-rouge">82.150.140[.]30</code>.</p><p>We can also pull the IP from the EK delivery from the alerts earlier, and map that to the hostname <code class="language-plaintext highlighter-rouge">stand.trustandprobaterealty[.]com</code>. Finally the redirect URL is the intermediary. Where did they go in between exploited site and delivery? <code class="language-plaintext highlighter-rouge">hxxp://24corp-shop[.]com/</code> will do it.</p><h3 id="question-9-other-than-cve-2013-2551-ie-exploit-what-other-exploits-sent-by-the-ek-format-comma-separated-in-alphabetical-order">Question 9: Other than CVE-2013-2551 IE exploit, what other exploit(s) sent by the EK? Format: comma-separated in alphabetical order</h3><p>For this, using the search <code class="language-plaintext highlighter-rouge">_path="files" | sort mime_type</code> was a quick way to find interesting events. The flash and java archives stick out and by right clicking the hash, you can very easily look up the files in virus-total and see the tags associated with the CVEs. I didn’t really understand the format it wanted it. These are the links <a href="https://www.virustotal.com/gui/file/e2e33b802a0d939d07bd8291f23484c2f68ccc33dc0655eb4493e5d3aebc0747/detection">here</a> and <a href="https://www.virustotal.com/gui/file/178be0ed83a7a9020121dee1c305fd6ca3b74d15836835cfb1684da0b44190d3/detection">here</a>.</p><p>I used up the hints here because I couldn’t figure out what format they wanted the answer in. The answer is <code class="language-plaintext highlighter-rouge">Flash,Java</code>.</p><h3 id="question-10-how-many-times-was-the-payload-delivered">Question 10: How many times was the payload delivered?</h3><p>To do this, let’s go to alerts again. Sort with this query <code class="language-plaintext highlighter-rouge">event_type=alert alert.severity=1 alert.category="Exploit Kit Activity Detected" | sort alert.signature</code> and we see the GoonEK delivered 3 times.</p><h3 id="question-11-what-are-the-sids-of-the-triggered-snort-alerts-in-the-network-trojan-category-format-comma-separated-in-ascending-order">Question 11: What are the SIDs of the triggered Snort alerts in the Network Trojan category? Format: comma-separated in ascending order</h3><p>I didn’t get this one. I used the files functionality in Brim to right click and search the file in VirusTotal, but nothing showed snort rule activity. I uploaded the pcap and was able to see quite a few rules fire off, but my final list did not match the answer to the test. The list of unique rules I ended up with 2014473, 2021430, 27816, 30934, and 30936, which I found by submitted the PCAP, doing a CTRL+F for <code class="language-plaintext highlighter-rouge">Network Trojan</code>, and viewing the rule IDs.</p><p>The correct answer was <code class="language-plaintext highlighter-rouge">25562,27816,30934,30936</code>. This is the rule from the answer I did not have in my list, available <a href="https://github.com/codecat007/snort-rules/blob/master/snortrules-snapshot-3000/rules/snort3-file-java.rules#L52">here</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre># alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -&gt; $HOME_NET any ( msg:"FILE-JAVA Oracle Java obfuscated jar file download attempt"; flow:established,to_client; flowbits:isset,file.jar; file_data; content:"Obfuscation by Allatori Obfuscator",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:trojan-activity; sid:25562; rev:9; )

</pre></table></code></div></div><h3 id="question-12-the-compromised-website-has-a-malicious-script-with-a-url-what-is-this-url">Question 12: The compromised website has a malicious script with a URL. What is this URL?</h3><p>This is easy, we know the URL we are going to end up at is <code class="language-plaintext highlighter-rouge">http://24corp-shop[.]com/</code> from earlier, and that’s the answer. I went through wireshark manually reviewing each of the javascript files and didn’t find this URL string in any of them, but I did learn we’re dealing with a Plesk server and those have some bad luck.</p><h3 id="question-13-extract-the-exploit-files-what-is-are-the-md5-file-hashes">Question 13: Extract the exploit file(s). What is (are) the MD5 file hash(es)?</h3><p>This query <code class="language-plaintext highlighter-rouge">_path="files" 37.200.69.143 in tx_hosts | sort mime_type</code> will get you all files from where the exploit was delivered from. View the java-archive and x-shockwave-flash files, go to the bottom right, and you’ll see the hashes. Submit those two as the answer.</p><h3 id="question-14-virustotal-doesnt-show-how-many-times-a-specific-rule-was-fired-under-the-suricata-alerts-section-for-the-pcap-analysis-run-the-pcap-file-against-your-local-suricata-emerging-threats-open-ruleset-and-provide-the-rule-number-that-was-fired-the-most">Question 14: VirusTotal doesn’t show how many times a specific rule was fired under the “Suricata alerts” section for the pcap analysis. Run the pcap file against your local Suricata (Emerging Threats Open ruleset) and provide the rule number that was fired the most</h3><p>For this one, the query <code class="language-plaintext highlighter-rouge">event_type=alert | count() by alert.signature_id | sort count</code> will bubble up the answer. Submit the signature ID without commas that fired the most, <code class="language-plaintext highlighter-rouge">2018297</code>.</p><h2 id="ok-thats-it">OK that’s it</h2><p>Good stuff. I enjoyed this exercise and will probably work through more. I submitted feedback on the ones that didn’t work as expected, so maybe I did something wrong or they can get updated. Either way, I really appreciate the work that went into this, this is a great learning resource.</p><h2 id="edit">Edit</h2><p>I submitted that support ticket and got a response the same night that the content would get updated. Really impressed with their turnaround.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/lab/'>lab</a>, <a href='/categories/homelab/'>homelab</a>, <a href='/categories/malware/'>malware</a>, <a href='/categories/traffic-analysis/'>traffic-analysis</a>, <a href='/categories/workflow/'>workflow</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CyberDefenders.org - Malware Traffic Analysis Walktrhough - Notepad+++&url=https://remotephone.github.io/posts/CyberDefenders_MTA/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CyberDefenders.org - Malware Traffic Analysis Walktrhough - Notepad+++&u=https://remotephone.github.io/posts/CyberDefenders_MTA/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=CyberDefenders.org - Malware Traffic Analysis Walktrhough - Notepad+++&url=https://remotephone.github.io/posts/CyberDefenders_MTA/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/what-is-markdown/">What is Markdown anyway?</a></li><li><a href="/posts/welcome-to-jekyll/">Welcome to My Scratchpad</a></li><li><a href="/posts/reverse-shell-cheatsheet/">Reverse Shell Cheat Sheet</a></li><li><a href="/posts/practical-docker-part2/">Practical Docker for Security Admins - Part 2</a></li><li><a href="/posts/practical-docker/">Practical Docker for Security Admins - Part 1</a></li></ul></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Messing-Around-With-Memory-Dumps/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Feb 2, 2020 <i class="unloaded">2020-02-02T23:00:00-06:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Messing Around with Memory Dumps</h3><div class="text-muted small"><p> Why am I here? This handy tweet was posted on twitter sharing a memory dump to look into. I don’t do much of any memory analysis at work, so I figured I’d stumble through this, write what I found,...</p></div></div></a></div><div class="card"> <a href="/posts/CyberDefenders_maldoc101/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Apr 13, 2021 <i class="unloaded">2021-04-13T00:40:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CyberDefenders.org - Maldoc101 Walkthrough</h3><div class="text-muted small"><p> Another go at CyberDefenders.org Having another go at a CyberDefenders challenge, this one about maldocs. You can find a link to the challenge here. Environment I did this through Windows Subsys...</p></div></div></a></div><div class="card"> <a href="/posts/CyberDefenders_Obfuscated/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 20, 2021 <i class="unloaded">2021-10-20T11:24:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CyberDefenders - Obfuscated</h3><div class="text-muted small"><p> Obfuscated Back again for another CyberDefenders post. This is Obfuscated and I’ll work this like the last one, poke around before I answer any questions. The prompt again is pretty simple, you g...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/DD-WRT_home_router/" class="btn btn-outline-primary"><p>DD-WRT as a home router</p></a> <a href="/posts/CyberDefenders_maldoc101/" class="btn btn-outline-primary"><p>CyberDefenders.org - Maldoc101 Walkthrough</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/remotephone">remotephone</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-158754701-1', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://remotephone.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
